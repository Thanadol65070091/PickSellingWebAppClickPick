{
  "openapi": "3.0.3",
  "info": {
    "title": "ClickPick API",
    "version": "1.0.0",
    "description": "E-commerce for customizable guitar picks"
  },
  "servers": [{ "url": "/api" }],
  "components": {
    "securitySchemes": {
      "bearerAuth": { "type": "http", "scheme": "bearer", "bearerFormat": "JWT" }
    },
    "schemas": {
      "User": { "type": "object", "properties": { "id": {"type":"string","format":"uuid"}, "name":{"type":"string"}, "email":{"type":"string"}, "role":{"type":"string","enum":["customer","admin"]}, "created_at":{"type":"string","format":"date-time"} } },
      "Product": { "type": "object", "properties": { "id":{"type":"string","format":"uuid"}, "name":{"type":"string"}, "description":{"type":"string"}, "price":{"type":"number"}, "stock":{"type":"integer"}, "image":{"type":"string"}, "category":{"type":"string","enum":["preset","gadget","custompick"]} } },
      "Customization": { "type":"object", "properties": { "shape":{"type":"string","enum":["standard","jazz","triangle"]}, "color":{"type":"string","enum":["#3B82F6","white"]}, "text":{"type":"string"} }, "required":["shape","color","text"] },
      "OrderItem": { "type":"object", "properties": { "id":{"type":"string","format":"uuid"}, "order_id":{"type":"string","format":"uuid"}, "product_id":{"type":"string","format":"uuid"}, "quantity":{"type":"integer"}, "price":{"type":"number"}, "customization_id":{"type":["string","null"],"format":"uuid"} } },
      "BillingDetail": { "type":"object", "properties": { "email":{"type":"string"}, "firstname":{"type":"string"}, "lastname":{"type":"string"}, "company":{"type":"string"}, "address":{"type":"string"}, "city":{"type":"string"}, "country":{"type":"string"}, "postal_code":{"type":"string"}, "phone":{"type":"string"}, "order_notes":{"type":"string"} }, "required":["email","firstname","lastname","address","city","country","postal_code","phone","company","order_notes"] },
      "Order": { "type":"object", "properties": { "id":{"type":"string","format":"uuid"}, "user_id":{"type":"string","format":"uuid"}, "status":{"type":"string","enum":["draft","pending","paid","shipped","delivered"]}, "total":{"type":"number"}, "delivery_fee":{"type":"number","example":14}, "discount":{"type":"number","example":0}, "billing_detail":{"$ref":"#/components/schemas/BillingDetail"}, "created_at":{"type":"string","format":"date-time"} } },
      "AuthResponse": { "type":"object", "properties": { "token":{"type":"string"}, "user":{"$ref":"#/components/schemas/User"} } },
      "Error": { "type":"object", "properties": { "error":{"type":"string"} } }
    }
  },
  "paths": {
    "/auth/register": {
      "post": {
        "summary": "Register",
        "requestBody": { "required": true, "content": { "application/json": { "schema": {"type":"object","properties":{"name":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"}},"required":["name","email","password"]}, "examples": {"default": {"value": {"name":"Demo","email":"demo@clickpick.dev","password":"Demo123!"}}}} } },
        "responses": { "201": {"description":"Created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}, "400": {"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}} }
      }
    },
    "/auth/login": {
      "post": {
        "summary": "Login",
        "requestBody": { "required": true, "content": { "application/json": { "schema": {"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"}},"required":["email","password"]}, "examples": {"default": {"value": {"email":"demo@clickpick.dev","password":"Demo123!"}}}} } },
        "responses": { "200": {"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}, "401": {"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}} }
      }
    },
    "/auth/me": { "get": { "summary":"Me", "security":[{"bearerAuth":[]}], "responses": { "200": {"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}}, "401": {"description":"Unauthorized"} } } },
    "/products": { "get": { "summary":"List products", "parameters":[{"in":"query","name":"q","schema":{"type":"string"}},{"in":"query","name":"category","schema":{"type":"string"}},{"in":"query","name":"limit","schema":{"type":"integer"}},{"in":"query","name":"offset","schema":{"type":"integer"}}], "responses": { "200": {"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Product"}}}} } } },
      "post": { "summary":"Create product","security":[{"bearerAuth":[]}], "responses": {"201": {"description":"Created"}, "403": {"description":"Forbidden"}} } },
    "/products/{id}": { "get": { "summary":"Get product", "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"},"404":{"description":"Not Found"}} },
      "put": { "summary":"Update","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"}} },
      "delete": { "summary":"Delete","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"204":{"description":"No Content"}} } },
    "/cart": { "get": { "summary":"Get draft cart","security":[{"bearerAuth":[]}], "responses": {"200":{"description":"OK"}} } },
    "/cart/items": { "post": { "summary":"Add item","security":[{"bearerAuth":[]}], "requestBody": {"required":true, "content": {"application/json": {"schema": {"type":"object","properties":{"product_id":{"type":"string"},"quantity":{"type":"integer"},"customization":{"$ref":"#/components/schemas/Customization"}}}, "examples": {"custompick": {"summary":"Custom pick add","value":{"product_id":"<uuid>","quantity":2,"customization":{"shape":"standard","color":"#3B82F6","text":"ROCK"}}}, "noncustom": {"summary":"Non-custom add","value":{"product_id":"<uuid>","quantity":1}} }}} }, "responses": {"201":{"description":"Created"},"400":{"description":"Bad Request"}} } },
    "/cart/items/{itemId}": { "put": { "summary":"Update item","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"itemId","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"}} },
      "delete": { "summary":"Remove item","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"itemId","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"}} } },
    "/cart/recalculate": { "post": { "summary":"Recompute totals","security":[{"bearerAuth":[]}], "responses": {"200":{"description":"OK"}} } },
    "/checkout": { "post": { "summary":"Checkout","security":[{"bearerAuth":[]}], "requestBody": {"required":true, "content": {"application/json": {"schema": {"$ref":"#/components/schemas/BillingDetail"}, "examples": {"withDashes": {"value": {"email":"demo@clickpick.dev","firstname":"Demo","lastname":"User","company":"-","address":"123 Street","city":"Bangkok","country":"Thailand","postal_code":"10110","phone":"0800000000","order_notes":"-"}}}} } }, "responses": {"200":{"description":"OK"},"400":{"description":"Bad Request"}} } },
    "/payment": { "post": { "summary":"Mock payment","security":[{"bearerAuth":[]}], "requestBody": {"required":true, "content": {"application/json": {"schema": {"type":"object","properties":{"order_id":{"type":"string"},"card_number":{"type":"string"},"name_on_card":{"type":"string"},"exp":{"type":"string"},"cvc":{"type":"string"}}, "required":["order_id"]}, "examples": {"success": {"value": {"order_id":"<uuid>","card_number":"4242424242424242","name_on_card":"DEMO USER","exp":"12/29","cvc":"123"}}, "insufficient": {"value": {"order_id":"<uuid>","card_number":"0000","name_on_card":"-","exp":"-","cvc":"-"}} }}} }, "responses": {"200":{"description":"Paid"},"409":{"description":"Insufficient stock"}} } },
    "/orders": { "get": { "summary":"List orders","security":[{"bearerAuth":[]}], "responses": {"200":{"description":"OK"}} } },
    "/orders/{id}": { "get": { "summary":"Get order","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"},"404":{"description":"Not Found"}} } },
    "/orders/{id}/ship": { "post": { "summary":"Mark shipped","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"},"403":{"description":"Forbidden"}} } },
    "/orders/{id}/deliver": { "post": { "summary":"Mark delivered","security":[{"bearerAuth":[]}], "parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}], "responses": {"200":{"description":"OK"},"403":{"description":"Forbidden"}} } }
  }
}

